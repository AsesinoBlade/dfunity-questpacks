-- Perpetual Quest
Quest: JHPQ027
DisplayName: Guardkiller
-- Message panels
QRC:

QuestorOffer:  [1000]
<ce>          ERROR 1000 JHPQ027

RefuseQuest:  [1001]
<ce>          ERROR 1001 JHPQ027

AcceptQuest:  [1002]
<ce>           ERROR 1002 JHPQ027

QuestFail:  [1003]
<ce>           ERROR 1003 JHPQ027

QuestComplete:  [1004]
<ce> Mere moments after the criminal is downed,
<ce> a guard catches up to you.
<ce> 
<ce> "Thank you, brave %ra! Such a villain
<ce> need not be given another chance.
<ce> Please wait for our courier."
<ce> 
<ce> You only wait another minute before a page
<ce> arrives with a bag of money for your reward.

Message:  1010
<ce> You're made aware of some roaring among the
<ce> townsfolk. A figure runs among the people.
<ce> You make out some faint shouts among them.
<ce> 
<ce> "Another guard down!" "Someone help!"
<ce> 
<ce> If you try to stop this murderer, there may
<ce> be a reward in it for you. Do you make the attempt?
<--->
<ce> You're made aware of some roaring among the
<ce> townsfolk. A figure runs among the people.
<ce> You make out some faint shouts among them.
<ce> 
<ce> "The guards are dying!" "We need help!"
<ce> 
<ce> If you try to stop this murderer, there may
<ce> be a reward in it for you. Do you make the attempt?

Message:  1011
<ce> You draw the foe's attention and begin the duel.

Message:  1012
<ce> This doesn't concern you. The criminal
<ce> makes a speedy escape and flees the town.
<--->
<ce>  This doesn't concern you. The city guard corner
<ce>  the criminal and deliver a swift execution.

Message:  1013
<ce>  You have more than enough experience with this kind
<ce>  to know what to say. You discreetly call the criminal's
<ce>  attention to yourself, pretending to be a friend who
<ce>  can help in this time of need.

QBN:
Clock _timer_ 1.00:00
Clock _failsafe_ 30.00:00

Foe _enemy_ is Nightblade

Item _reward1_ gold range 800 to 800
Item _reward2_ gold range 1000 to 1000

--	Quest start-up:
    start timer _failsafe_

_begin_ task:
    when pc enters tavernhome
    prompt 1010 yes _try_ no _quit_
    start timer _timer_

_quit_ task:
    say 1012
    end quest

variable _try_
_adv_ task:
    when skill Streetwise is at least 40

_tro_ task:
    when _try_ and not _adv_
    say 1011
    create foe _enemy_ every 0 minutes 1 times with 100% success

_nottro_ task:
    when _try_ and _adv_
    say 1013
    create foe _enemy_ every 0 minutes 1 times with 100% success
    restrain foe _enemy_

_slain_ task:
    killed _enemy_
    pick one of _rew1_ _rew2_

_rew1_ task:
    give pc _reward1_
    -legalrep +20
    end quest

_rew2_ task:
    give pc _reward2_
    -legalrep +20
    end quest

_timer_ task:
    end quest

_failsafe_ task:
    end quest